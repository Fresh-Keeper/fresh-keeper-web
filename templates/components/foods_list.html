<div class="bg-white rounded-md">
  <div class="text-left flex">
    <button
      class="flex-1 box-border h-10 w-30 bg-lime-100 text-gray-300"
      id="btn-refrigeration"
      onclick="show_refrigeration()"
    >
      냉장
    </button>
    <button
      class="flex-1 box-border h-10 w-30 bg-lime-100 text-gray-300"
      id="btn-freeze"
      onclick="show_freeze()"
    >
      냉동
    </button>
  </div>
  <hr />
  <!-- 냉장 물품 리스트 -->
  <ul id="refrigeration_list" style="display: none">
    {%for food in cold_food_list%} {% if food["food_remained_date"] > 3 %}
    <li
      class="flex justify-between p-5"
      id="{{food['_id']}}"
      onclick="detail(this.id)"
    >
      {% elif food["food_remained_date"] > 0 %}
    </li>
    <li
      class="flex justify-between p-5 bg-red-300"
      id="{{food['_id']}}"
      onclick="detail(this.id)"
    >
      {% else %}
    </li>

    <li
      class="flex justify-between p-5 bg-gray-300"
      id="{{food['_id']}}"
      onclick="detail(this.id)"
    >
      {% endif %}
      <div>
        <p>{{food["food_name"]}}</p>
        <p>{{food["food_purchase_date"]}}</p>
      </div>
      <div class="flex items-center justify-center">
        D-{{food["food_remained_date"]}}
      </div>
    </li>
    <hr />
    {%endfor%}
  </ul>
  <!-- 냉동 물품 리스트 -->
  <ul id="freeze_list" style="display: none">
    {%for food in frozed_food_list%} {% if food["food_remained_date"] > 3 %}
    <li
      class="flex justify-between p-5"
      id="{{food['_id']}}"
      onclick="detail(this.id)"
    >
      {% elif food["food_remained_date"] > 0 %}
    </li>

    <li
      class="flex justify-between p-5"
      style="background-color: #e67d7d"
      id="{{food['_id']}}"
      onclick="detail(this.id)"
    >
      {% else %}
    </li>

    <li
      class="flex justify-between p-5"
      style="background-color: #bab8b8"
      id="{{food['_id']}}"
      onclick="detail(this.id)"
    >
      {% endif %}
      <div>
        <p>{{food["food_name"]}}</p>
        <p>{{food["food_purchase_date"]}}</p>
      </div>
      <div class="flex items-center justify-center">
        D-{{food["food_remained_date"]}}
      </div>
    </li>
    <hr />
    {%endfor%}
  </ul>
</div>

<div class="h-full flex justify-center items-center">
  <div class="bg-white mx-5 p-5 rounded-2xl h-[80%] w-full" id="food-detail">
    <div class="w-full text-right text-3xl" onclick="closeDetail()">X</div>
    <div class="grid grid-rows-6 gap-10 pt-5 text-xl">
      <p class="text-slate-500 text-3xl" id="detail-name">
        detailInfo.food_name
      </p>
      <p class="flex justify-around text-xl">
        <span>구매 날짜</span>
        <span id="detail-date">클릭한 식료품 구매 날짜</span>
      </p>
      <p class="flex justify-around text-xl">
        <span>구매 날짜</span>
        <span id="detail-limit">클릭한 식료품 소비 기한</span>
      </p>
      <p class="flex justify-around text-xl">
        <span>권장 소비 기한</span>
        <span id="detail-remained"></span>
      </p>
      <div class="grid grid-cols-3 text-xl">
        <button class="text-3xl" id="minus" onclick="updateAmount(this.id)">
          -
        </button>
        <span id="detail-amount">클릭한 식료품 수량</span>
        <button class="text-3xl" id="plus" onclick="updateAmount(this.id)">
          +
        </button>
      </div>
    </div>
    <div>
      <button
        class="text-2xl w-[80%] text-white bg-red-700 hover:bg-red-800 rounded-2xl p-3"
        onclick="deleteFood()"
      >
        삭제
      </button>
    </div>
  </div>
</div>

<script>
  $(document).ready(function () {
    show_refrigeration();
  });
  function show_refrigeration() {
    $("#refrigeration_list").show();
    $("#freeze_list").hide();
    $("#btn-refrigeration").addClass("bg-lime-500");
    $("#btn-freeze").removeClass("bg-lime-500");
    $("#btn-refrigeration").addClass("text-white");
    $("#btn-freeze").removeClass("text-white");
  }

  function show_freeze() {
    $("#refrigeration_list").hide();
    $("#freeze_list").show();
    $("#btn-refrigeration").removeClass("bg-lime-500");
    $("#btn-freeze").addClass("bg-lime-500");
    $("#btn-refrigeration").removeClass("text-white");
    $("#btn-freeze").addClass("text-white");
  }

  function detail(id) {
    $("#food-detail").addClass("hidden");

    $.ajax({
      type: "POST",
      url: "/foods/detail",
      data: { food_id_give: id },
      success: function (response) {
        if (response["result"] == 200) {
          const info = response["food_detail"];
          $("#detail-name").text(info.food_name);
          $("#detail-date").text(info.food_purchase_date);
          $("#detail-limit").text(info.food_limited_date);
          $("#detail-remained").text(`${info.food_remained_date}일 남음`);
          $("#detail-amount").text(info.food_amount);
          $("#food-detail").removeClass("hidden");
        }
      },
    });
  }

  function closeDetail() {
    $("#food-detail").addClass("hidden");
  }

  function updateAmount(id) {
    let updateValue = $("#detail-amount").val();
    if (id == "minus") {
      updateValue < 0 ? deleteFood() : updateValue--;
    }
    if (id == "plus") {
      updateValue++;
    }

    $.ajax({
      // updateValue 전송
    });
  }

  function deleteFood() {
    const deleteOk = confirm("삭제하시겠습니까?");
    if (deleteOk) {
      // 식품 삭제 api 요청
    }
  }
</script>
